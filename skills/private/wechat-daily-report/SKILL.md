---
name: wechat-daily-report
description: 生成微信聊天今日报告，包含数据统计、待办事项提炼、趣事吃瓜整理。适用于"微信日报"、"今日微信报告"、"聊天记录分析"等场景。
---

# 目标

从本地 DuckDB 读取微信聊天记录，生成结构化的今日报告 Markdown 文件，包含：
- 数据概览（消息总数、活跃聊天、时间分布）
- **待办事项**：按优先级分类，概括提炼需要跟进的工作
- **趣事吃瓜**：整理成完整故事，而非零碎消息
- 幽默总结收尾

# 流程

## 第一步：提取原始数据

运行脚本获取当日聊天数据：

```bash
python3 scripts/extract_data.py [--date YYYY-MM-DD] [--db PATH]
```

脚本会输出：
1. 数据统计（消息数、活跃度、时间分布）
2. 工作群完整对话（用于分析待办）
3. 非工作群对话（用于提取趣事）

## 第二步：概括提炼（AI 完成）

根据原始数据，分析并概括：

### 待办事项提炼规则

1. **识别待办来源**：
   - 被 @淇奥 的消息
   - 包含问题/故障/请求的对话
   - 需要确认/跟进/反馈的事项

2. **按优先级分类**：
   - 🔴 需立即处理：今天要做的、已答应的
   - 🟡 本周跟进：有明确时间节点的
   - 🟢 已解决/知悉：已完成或仅需知悉的

3. **格式要求**：
   ```markdown
   1. **事项标题**
      - 来源：群名/联系人 + 时间
      - 具体内容描述
      - 状态：当前进展
   ```

### 趣事吃瓜提炼规则

1. **识别有趣内容**：
   - 群友热议的话题（多人参与讨论）
   - 包含吃瓜/八卦/搞笑关键词
   - 有完整故事线的对话

2. **整理成故事**：
   - 给每个故事起标题 + emoji
   - 概括事件经过，保留精彩原话
   - 突出笑点/槽点

3. **格式要求**：
   ```markdown
   ### 🍉 故事标题

   故事概括描述，**加粗关键信息**，保留群友精彩原话用引用格式。
   ```

### 今日总结

用一句幽默的话收尾，结合当天的待办和趣事，例如：
> 33 个工作群在线 battle，Git 文件夹还没建，但最重要的是——玩剑网三的红包领不了。

## 第三步：生成报告

将分析结果整理成完整的 Markdown 报告，保存到指定目录。

# 报告模板

```markdown
# 微信日报 (YYYY-MM-DD 周X)

## 一、数据概览
| 指标 | 数值 |
|------|------|
| **消息总数** | X 条 |
| **活跃聊天** | X 个 |
| **活跃人数** | X 人 |
| **峰值时段** | XX:00 (X条) |

## 二、聊天活跃度 TOP 10
（表格）

## 三、消息类型分布
（列表）

## 四、待办事项
### 🔴 需立即处理
### 🟡 本周跟进
### 🟢 已解决/知悉

## 五、趣事吃瓜
### 🍉 故事1
### 📱 故事2
...

## 六、活跃发送者 TOP 10
（表格）

## 七、消息时间分布
（柱状图）

## 今日总结
> 幽默收尾语

---
*报告生成时间: YYYY-MM-DD HH:MM:SS*
```

# 护栏

- 只读操作，不修改数据库
- 待办事项只提取工作相关聊天
- 趣事吃瓜不包含敏感/隐私内容
- 报告默认输出到当前目录

# 资源

- `scripts/extract_data.py`：数据提取脚本
- `scripts/generate_report.py`：基础报告生成脚本（统计部分）

# 使用示例

```bash
# 1. 提取今日数据
python3 scripts/extract_data.py

# 2. AI 根据输出概括提炼，生成最终报告

# 或者直接让 AI 生成（推荐）
# "帮我生成今日微信报告"
```
